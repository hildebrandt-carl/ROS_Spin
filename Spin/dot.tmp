digraph p_master {
size="8,10";
  GT [shape=box,style=dotted,label="master"];
  GT -> S1;
	S1 -> S31  [color=black,style=bold,label="active_mast = (active_mast+1)"];
	S31 -> S3  [color=black,style=bold,label="in?pub,namespace"];
	S31 -> S11  [color=black,style=bold,label="in?sub,namespace"];
	S31 -> S34  [color=black,style=bold,label="((msgs_sent==tot_message))"];
	S31 -> S34  [color=black,style=bold,label="((msgs_sent>tot_message))"];
	S31 -> S31  [color=black,style=bold,label="(timeout)"];
	S3 -> S9  [color=black,style=solid,label="printf('MASTER: Pub requesting registration ')"];
	S9 -> S5  [color=black,style=dashed,label="assert((mas_table_number<5))"];
	S5 -> S6  [color=black,style=dashed,label="mas_table[mas_table_number] = namespace"];
	S6 -> S7  [color=black,style=dashed,label="printf('MASTER: New byte %c received and stored in position %d ',namespace,mas_table_number)"];
	S7 -> S8  [color=black,style=dashed,label="mas_table_number = (mas_table_number+1)"];
	S8 -> S31  [color=black,style=bold,label="out!puback,namespace"];
	S11 -> S23  [color=black,style=solid,label="printf('MASTER: Sub requesting registration ')"];
	S23 -> S13  [color=black,style=bold,label="((mas_table[0]==namespace))"];
	S23 -> S15  [color=black,style=bold,label="((mas_table[1]==namespace))"];
	S23 -> S17  [color=black,style=bold,label="((mas_table[2]==namespace))"];
	S23 -> S19  [color=black,style=bold,label="((mas_table[3]==namespace))"];
	S23 -> S21  [color=black,style=bold,label="((mas_table[4]==namespace))"];
	S23 -> S31  [color=black,style=bold,label="(1)"];
	S13 -> S31  [color=black,style=bold,label="out!suback,namespace"];
	S15 -> S31  [color=black,style=bold,label="out!suback,namespace"];
	S17 -> S31  [color=black,style=bold,label="out!suback,namespace"];
	S19 -> S31  [color=black,style=bold,label="out!suback,namespace"];
	S21 -> S31  [color=black,style=bold,label="out!suback,namespace"];
	S34 -> S35  [color=black,style=solid,label="printf('MASTER: Ended ')"];
	S35 -> S36  [color=black,style=bold,label="active_mast = (active_mast-1)"];
	S36 -> S0  [color=black,style=solid,label="-end-"];
  S36 [color=blue,style=bold,shape=box];
}
digraph p_publisher {
size="8,10";
  GT [shape=box,style=dotted,label="publisher"];
  GT -> S1;
	S1 -> S2  [color=black,style=solid,label="printf('PUBLISHER: HERER ')"];
	S2 -> S3  [color=black,style=solid,label="registered_pub = 0"];
	S3 -> S42  [color=black,style=bold,label="active_pubs = (active_pubs+1)"];
	S42 -> S5  [color=black,style=bold,label="((registered_pub==0))"];
	S42 -> S15  [color=black,style=bold,label="((registered_pub==1))"];
	S42 -> S45  [color=black,style=bold,label="((registered_pub==2))"];
	S42 -> S45  [color=black,style=bold,label="((msgs_sent==tot_message))"];
	S5 -> S11  [color=black,style=solid,label="printf('PUBLISHER: Requesting Publisher Registration ')"];
	S11 -> S11  [color=black,style=bold,label="out!pub,97"];
	S11 -> S10  [color=black,style=bold,label="in?puback,97"];
	S10 -> S9  [color=black,style=dashed,label="registered_pub = 1"];
	S9 -> S42  [color=black,style=solid,label="goto start"];
	S15 -> S33  [color=black,style=solid,label="printf('PUBLISHER: Publisher Registered ')"];
	S33 -> S17  [color=black,style=bold,label="((msgs_sent<tot_message))"];
	S33 -> S28  [color=black,style=bold,label="((msgs_sent==tot_message))"];
	S33 -> S31  [color=black,style=bold,label="((msgs_sent>tot_message))"];
	S17 -> S23  [color=black,style=solid,label="printf('PUBLISHER: Publishing %c ',message)"];
	S23 -> S19  [color=black,style=bold,label="(empty(p2s))"];
	S23 -> S22  [color=black,style=bold,label="(full(p2s))"];
	S19 -> S20  [color=black,style=bold,label="p2s!message"];
	S20 -> S25  [color=black,style=solid,label="printf('PUBLISHER: Sending messsage ')"];
	S25 -> S26  [color=black,style=solid,label="printf('PUBLISHER: Counting messsage ')"];
	S26 -> S33  [color=black,style=bold,label="msgs_sent = (msgs_sent+1)"];
	S22 -> S25  [color=black,style=solid,label="printf('PUBLISHER: Dropping messsage ')"];
	S28 -> S42  [color=black,style=solid,label="registered_pub = 2"];
	S31 -> S42  [color=black,style=solid,label="registered_pub = 2"];
	S45 -> S46  [color=black,style=solid,label="printf('PUBLISHER: Ended ')"];
	S46 -> S47  [color=black,style=bold,label="active_pubs = (active_pubs-1)"];
	S47 -> S0  [color=black,style=solid,label="-end-"];
  S47 [color=blue,style=bold,shape=box];
}
digraph p_subscriber {
size="8,10";
  GT [shape=box,style=dotted,label="subscriber"];
  GT -> S1;
	S1 -> S2  [color=black,style=solid,label="printf('SUBSCRIBER: HERER ')"];
	S2 -> S3  [color=black,style=solid,label="inputMessage = 0"];
	S3 -> S4  [color=black,style=solid,label="registered_sub = 0"];
	S4 -> S42  [color=black,style=bold,label="active_subs = (active_subs+1)"];
	S42 -> S6  [color=black,style=bold,label="((registered_sub==0))"];
	S42 -> S16  [color=black,style=bold,label="((registered_sub==1))"];
	S42 -> S45  [color=black,style=bold,label="((registered_sub==2))"];
	S42 -> S45  [color=black,style=bold,label="((msgs_sent==tot_message))"];
	S6 -> S12  [color=black,style=solid,label="printf('SUBSCRIBER: Requesting Subscriber Registration ')"];
	S12 -> S12  [color=black,style=bold,label="out!sub,97"];
	S12 -> S11  [color=black,style=bold,label="in?suback,97"];
	S11 -> S10  [color=black,style=dashed,label="registered_sub = 1"];
	S10 -> S42  [color=black,style=solid,label="goto start"];
	S16 -> S33  [color=black,style=solid,label="printf('SUBSCRIBER: Subscriber Registered ')"];
	S33 -> S27  [color=black,style=bold,label="p2s?inputMessage"];
	S33 -> S29  [color=black,style=bold,label="(((active_pubs==0)&&(tot_message>1)))"];
	S33 -> S42  [color=black,style=bold,label="(timeout)"];
	S27 -> S25  [color=black,style=dashed,label="printf('SUBSCRIBER: Subscriber Recieved %c ',inputMessage)"];
	S25 -> S20  [color=black,style=dashed,label="((inputMessage==97))"];
	S25 -> S22  [color=black,style=dashed,label="((inputMessage==98))"];
	S25 -> S24  [color=black,style=dashed,label="((inputMessage==99))"];
	S20 -> S26  [color=black,style=dashed,label="a_count = (a_count+1)"];
	S26 -> S33  [color=black,style=bold,label=".(goto)"];
	S22 -> S26  [color=black,style=dashed,label="b_count = (b_count+1)"];
	S24 -> S26  [color=black,style=dashed,label="c_count = (c_count+1)"];
	S29 -> S42  [color=black,style=solid,label="registered_sub = 2"];
	S45 -> S46  [color=black,style=solid,label="printf('SUBSCRIBER: Ended ')"];
	S46 -> S47  [color=black,style=bold,label="active_subs = (active_subs-1)"];
	S47 -> S0  [color=black,style=solid,label="-end-"];
  S47 [color=blue,style=bold,shape=box];
}
digraph init {
size="8,10";
  GT [shape=box,style=dotted,label="init"];
  GT -> S1;
	S1 -> S2  [color=black,style=solid,label="(run master(n2m,m2n))"];
	S2 -> S12  [color=black,style=solid,label="(run subscriber(m2n,n2m,p2s))"];
	S12 -> S4  [color=black,style=bold,label="((tot_pubs==1))"];
	S12 -> S6  [color=black,style=bold,label="((tot_pubs==2))"];
	S12 -> S9  [color=black,style=bold,label="((tot_pubs==3))"];
	S4 -> S18  [color=black,style=solid,label="(run publisher(m2n,n2m,p2s,97))"];
	S18 -> S21  [color=black,style=bold,label="((((active_mast+active_pubs)+active_subs)==0))"];
	S18 -> S17  [color=black,style=bold,label="else"];
	S21 -> S22  [color=black,style=solid,label="printf('Ended safely ')"];
	S22 -> S23  [color=black,style=bold,label="printf('Total attempted messages sent : %d ',tot_message)"];
	S23 -> S24  [color=black,style=bold,label="printf('Total successful message sent : %d ',((a_count+b_count)+c_count))"];
	S24 -> S25  [color=black,style=bold,label="printf('Total successful messages from publisher 1: %d ',a_count)"];
	S25 -> S26  [color=black,style=bold,label="printf('Total successful messages from publisher 2: %d ',b_count)"];
	S26 -> S27  [color=black,style=bold,label="printf('Total successful messages from publisher 3: %d ',c_count)"];
	S27 -> S0  [color=black,style=solid,label="-end-"];
  S27 [color=blue,style=bold,shape=box];
	S17 -> S18  [color=black,style=solid,label="(1)"];
	S6 -> S7  [color=black,style=solid,label="(run publisher(m2n,n2m,p2s,97))"];
	S7 -> S18  [color=black,style=solid,label="(run publisher(m2n,n2m,p2s,98))"];
	S9 -> S10  [color=black,style=solid,label="(run publisher(m2n,n2m,p2s,97))"];
	S10 -> S11  [color=black,style=solid,label="(run publisher(m2n,n2m,p2s,98))"];
	S11 -> S18  [color=black,style=solid,label="(run publisher(m2n,n2m,p2s,99))"];
}
